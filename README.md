# Обнаружение дефектов на чипе
Дефекты разделили на следующие классы:
1. Залипание электродов - асимметричное расположение параллельных контактов электродов
2. Одиночное залипание электродов
3. Загрязнение чипа - черные точки и царапины на чипе
4. Обломки на поверхности чипа
5. Отсутствие слоя чипа
6. Проблемы снимка - мутное изображение, расфокусировка


К решению задачи подошли от простого к сложному. 
## Классические методы
В первой итерации опробованы классические методы компьютерного зрения, такие как срезы, преобразование Фурье и преобразование Хафа через алгоритм обнаружения границ Собеля. 

Рабочей гипотезой оказался метод срезов для определения степени залипания электродов, так как на изображениях присутствует масштаб и можно перейти от пиксельных величин к физическим. Данный метод будет полезен в постобработке изображений

## Датасет
Датасет был размечен на платформе Roboflow. Размечено 2000 изображений по 1000 для верхней и нижней части чипа. Присутствует явный дисбаланс классов, примерно в половине случаев чип имеет залипание электродов, в меньшей степени присутствуют снимки с отсутсвием слоя,  одиночным залипанием и проблемой со снимками. 

## UNet
Обучение с учителем проводилось на архитектуре UNet на представленных выше классах. Данная архитектура имеет множество реализаций, позволяет решать мультиклассовую семантическую сегментацию и не требует высокопроизводительных ресурсов для обучения и инференса. 
По результатам обучения был сделан вывод, что нейросети сложно определить разницу между нормальными электродами и электродами с залипанием, а также сложно определить точечные дефекты, так как их недостаточно в обучающем наборе. Но стоит выделить, что нейросеть хорошо определяет левую и правую часть электродов, что можно использовать в постобработке. 

Большим недостатком обучения с учителем в данной задаче является то, что дефекты могут принимать разную форму и при каждом новом дефекте на производстве, нейросеть нужно переобучать заново. Из чего делается вывод, что нужно решать задачу поиска **аномалий**.

## Anomalib




